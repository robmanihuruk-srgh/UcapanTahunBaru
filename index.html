<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>üåå Tahun Baru 2026 ‚Äì GKPS Tangerang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: Inter, sans-serif;
      color: #f5f5f5;
      background: radial-gradient(circle at top, #0b1430, #000);
      min-height: 100vh;
      overflow-x: hidden;
    }
    canvas#fx { position: fixed; inset: 0; z-index: 0 }

    .container {
      position: relative; z-index: 1;
      min-height: 100vh; display: flex; align-items: center; justify-content: center;
      padding: 24px;
    }
    .card {
      width: 100%; max-width: 820px;
      background: rgba(255,255,255,.08);
      border-radius: 30px;
      backdrop-filter: blur(22px);
      box-shadow: 0 50px 160px rgba(0,0,0,.9);
      overflow: hidden;
      animation: rise 1.3s ease forwards;
    }
    @keyframes rise { from {opacity:0; transform:translateY(50px)} to {opacity:1; transform:none} }

    .photo-wrapper { 
      display:flex; 
      flex-direction:column; 
      align-items:center; 
      padding: 24px 24px 0;
    }
    .photo {
      width: 100%;
      max-height: 450px;
      border-radius: 22px;
      overflow: hidden;
      box-shadow: 0 25px 80px rgba(0,0,0,.7);
      display: flex;
      justify-content: center;
      background: rgba(0,0,0,0.2);
    }
    .photo img { 
      max-width: 100%; 
      max-height: 450px; 
      height: auto; 
      width: auto; 
      object-fit: contain; 
    }

    .content { padding: 20px 32px 42px; text-align:center }
    h1 { font-family:'Playfair Display',serif; font-size:clamp(30px,6vw,52px); margin:18px 0 6px }
    h1 span { color:#ffd88a; text-shadow:0 0 22px rgba(255,216,138,.8) }
    .subtitle { font-size:15px; opacity:.85; letter-spacing: 2px; }
    .verse { margin:22px auto 0; min-height: 80px; max-width:520px; line-height:1.9; font-size:16px; font-style: italic; color: #e0e0e0; }
    .signature { margin-top:26px; font-weight:600; color:#ffd88a; font-size: 1.2em; }

    .editor { margin-top:20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }
    .editor input { 
      padding:12px 18px; 
      border-radius:12px; 
      border: 1px solid rgba(255,255,255,0.2); 
      width: 80%; 
      max-width:340px; 
      background: rgba(255,255,255,0.1);
      color: #fff;
      margin-bottom: 10px;
    }

    .btn-group { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
    
    .share { position:fixed; top:16px; right:16px; z-index:5 }
    .btn { 
      padding:10px 18px; 
      border-radius:16px; 
      background:rgba(255,255,255,.18); 
      border:1px solid rgba(255,255,255,.3); 
      color:#fff; 
      cursor:pointer; 
      backdrop-filter: blur(5px);
      transition: 0.3s;
    }
    .btn:hover { background: rgba(255,255,255,0.3); }
    .btn-secondary { background: rgba(255, 216, 138, 0.2); border-color: #ffd88a; color: #ffd88a; }

    .locked .editor, .locked #photoInput { display:none }

    @media (max-width:480px){ 
      .photo img { max-height: 350px; } 
      .content { padding:26px 22px 36px } 
    }
  </style>
</head>
<body>

<canvas id="fx"></canvas>

<audio id="music" loop>
  <source src="Music_NewYear.mp4" type="audio/mp4">
</audio>

<div class="share">
  <button class="btn" id="shareBtn" type="button">üì§ Bagikan</button>
</div>

<div class="container" id="app">
  <div class="card">
    <div class="photo-wrapper">
      <div class="photo">
        <img id="photoPreview" src="faminbali.jfif" alt="Foto Keluarga" />
      </div>
      <input type="file" id="photoInput" accept="image/*" style="margin-top:14px;color:#ccc; font-size: 12px;" />
    </div>

    <div class="content">
      <h1>Selamat Tahun Baru <span>2026</span></h1>
      <div class="subtitle">Damai ‚Ä¢ Terang ‚Ä¢ Harapan</div>
      <div class="verse" id="verse"></div>
      <div class="signature" id="sign"></div>
      
      <div class="editor">
        <input type="text" id="nameInput" placeholder="Nama Keluarga / Pengirim" />
        <div class="btn-group">
            <button class="btn btn-secondary" id="randomBtn">‚ú® Acak Ucapan</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// --- Particle FX ---
const c=document.getElementById('fx'),x=c.getContext('2d'); let w,h,p=[];
function rs(){w=c.width=innerWidth;h=c.height=innerHeight} rs(); addEventListener('resize',rs);
for(let i=0;i<120;i++)p.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*2+0.5,s:Math.random()+0.2});
(function a(){x.clearRect(0,0,w,h);p.forEach(o=>{o.y+=o.s;o.y%=h;x.fillStyle='rgba(255,215,140,.7)';x.beginPath();x.arc(o.x,o.y,o.r,0,7);x.fill()});requestAnimationFrame(a)})();

// --- Quotes Data ---
const LIST_UCAPAN = [
  "‚ÄúSegala Impian dan Harapan Terwujud, Diberikan Kesehatan, Kebahagiaan, dan Rezeki yang Mengalir Deras.‚Äù",
  "‚ÄúKiranya terang Ilahi menyertai setiap langkah kita di tahun yang baru, membawa damai sejahtera bagi kita semua.‚Äù",
  "‚ÄúSelamat tinggal 2025, selamat datang 2026. Semoga kasih Tuhan selalu menyertai perjalanan keluarga kita.‚Äù",
  "‚ÄúTahun baru adalah lembaran bersih untuk menuliskan cerita indah dalam iman dan pengharapan baru.‚Äù",
  "‚ÄúBerjalanlah dengan iman di tahun 2026. Kiranya berkat Tuhan melimpah atas rumah tangga dan pekerjaan kita.‚Äù",
  "‚ÄúSemoga di tahun 2026 ini, setiap doa-doa kita dijawab dengan cara Tuhan yang paling indah.‚Äù"
];

// --- Core Logic ---
const q=new URLSearchParams(location.search); 
const n=q.get('name');
const vIdx=q.get('v'); // Parameter untuk menyimpan indeks ucapan
const app=document.getElementById('app'), sign=document.getElementById('sign'), verseEl=document.getElementById('verse');
const nameInput=document.getElementById('nameInput'), photoInput=document.getElementById('photoInput'), photoPreview=document.getElementById('photoPreview');
const music = document.getElementById('music');

let currentQuoteIndex = vIdx ? parseInt(vIdx) : 0;
let typingTimer;

function typeWriter(text, i = 0) {
  if (i === 0) verseEl.textContent = '';
  if (i < text.length) {
    verseEl.textContent += text[i];
    typingTimer = setTimeout(() => typeWriter(text, i + 1), 40);
  }
}

function updateVerse(index) {
  clearTimeout(typingTimer);
  currentQuoteIndex = index;
  typeWriter(LIST_UCAPAN[index]);
}

// Initial Load
if(n){ 
  sign.textContent = n; 
  nameInput.value = n; 
  app.classList.add('locked'); 
}
updateVerse(currentQuoteIndex);

// Buttons
document.getElementById('randomBtn').onclick = () => {
  let newIdx;
  do { newIdx = Math.floor(Math.random() * LIST_UCAPAN.length); } while (newIdx === currentQuoteIndex);
  updateVerse(newIdx);
};

document.body.addEventListener('click',()=>{ if(music.paused) music.play().catch(()=>{}); },{once:false});

nameInput.addEventListener('input',()=>sign.textContent=nameInput.value);

photoInput.addEventListener('change',e=>{
  const f=e.target.files[0]; if(!f)return;
  const r=new FileReader(); r.onload=v=>photoPreview.src=v.target.result; r.readAsDataURL(f);
});

document.getElementById('shareBtn').onclick=()=>{
  const v=nameInput.value.trim(); 
  if(!v){alert('Isi nama dulu');return}
  const url=`${location.origin}${location.pathname}?name=${encodeURIComponent(v)}&v=${currentQuoteIndex}`;
  if(navigator.share){
    navigator.share({title:'Tahun Baru 2026', text:`Ucapan dari ${v}`, url}).catch(()=>{});
  } else {
    navigator.clipboard?.writeText(url).then(()=>alert('Link disalin ke clipboard!'));
  }
};
</script>
</body>
</html>
